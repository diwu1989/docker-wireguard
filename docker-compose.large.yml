version: "3.5"
networks:
  wireguard:
services:
  haproxy:
    image: eeacms/haproxy
    ports:
      - "0.0.0.0:1080:1080"
    networks:
      - wireguard
    restart: always
    environment:
      LOG_LEVEL: info
      TIMEOUT_CONNECT: 500
      TIMEOUT_CLIENT: 2000
      TIMEOUT_SERVER: 2000
      FRONTEND_PORT: 1080
      BACKENDS_MODE: tcp
      BACKENDS: "p0:1080 p1:1080 p2:1080 p3:1080 p4:1080 p5:1080 p6:1080 p7:1080 p8:1080 p9:1080 p10:1080 p11:1080 p12:1080 p13:1080 p14:1080 p15:1080 p16:1080 p17:1080 p18:1080 p19:1080 p20:1080 p21:1080 p22:1080 p23:1080 p24:1080 p25:1080 p26:1080 p27:1080 p28:1080 p29:1080 p30:1080 p31:1080 p32:1080 p33:1080 p34:1080 p35:1080 p36:1080 p37:1080 p38:1080 p39:1080 p40:1080 p41:1080 p42:1080 p43:1080 p44:1080 p45:1080 p46:1080 p47:1080 p48:1080 p49:1080"
  p0:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p1:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p2:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p3:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p4:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p5:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p6:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p7:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p8:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p9:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p10:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p11:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p12:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p13:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p14:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p15:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p16:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p17:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p18:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p19:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p20:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p21:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p22:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p23:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p24:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p25:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p26:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p27:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p28:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p29:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p30:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p31:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p32:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p33:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p34:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p35:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p36:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p37:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p38:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p39:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p40:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p41:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p42:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p43:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p44:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p45:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p46:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p47:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p48:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard
  p49:
    image: diwu1989/wireguardproxy
    restart: always
    privileged: true
    environment:
      STAGGERED_START: 30
      RECONNECT_INTERVAL: 90
    networks:
      - wireguard